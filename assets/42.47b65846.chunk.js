(this["webpackJsonpbabydoge-frontend"]=this["webpackJsonpbabydoge-frontend"]||[]).push([[42],{1674:function(e,t,n){"use strict";n.r(t),n.d(t,"activeListeningKeys",(function(){return M})),n.d(t,"outdatedListeningKeys",(function(){return I})),n.d(t,"default",(function(){return E}));var r=n(1),c=n(13),u=n(7),a=n(0),o=n(30),i=n(395),l=n(32),s=n(262),b=n(15),f=n(14),d=n(20),h=n(21),m=n(103);function v(e,t){return n=e+Math.round(Math.random()*Math.max(0,t-e)),new Promise((function(e){return setTimeout(e,n)}));var n}var O=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(f.a)(this,n),t.call(this,"Cancelled")}return Object(b.a)(n)}(Object(m.a)(Error)),k=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n)}(Object(m.a)(Error));var j=n(92),p=n(26);var g=n(38),x=n(147),N=500;function y(e,t,n){return w.apply(this,arguments)}function w(){return(w=Object(u.a)(Object(r.a)().mark((function e(t,n,u){var a,o,i,l,s,b,f,d,h,m,v,O,j,p;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("Fetching chunk",t,n,u),a=Object(x.c)(u),e.prev=2,e.next=5,t.tryAggregate(!1,n.map((function(e){return[e.address,e.callData]})),{blockTag:u});case 5:i=e.sent,o=i.map((function(e){var t=e.success,n=e.returnData;return t?n:null})),e.next=30;break;case 9:if(e.prev=9,e.t0=e.catch(2),console.log("err",e.t0),!(-32e3===(h=e.t0).code||null!==h&&void 0!==h&&null!==(l=h.data)&&void 0!==l&&l.message&&-1!==(null===h||void 0===h||null===(s=h.data)||void 0===s||null===(b=s.message)||void 0===b?void 0:b.indexOf("header not found"))||-1!==(null===(f=h.message)||void 0===f?void 0:f.indexOf("header not found")))){e.next=17;break}throw new k("header not found for block number ".concat(u));case 17:if(-32603!==h.code&&-1===(null===(d=h.message)||void 0===d?void 0:d.indexOf("execution ran out of gas"))){e.next=28;break}if(!(n.length>1)){e.next=28;break}return m=Math.floor(n.length/2),e.next=23,Promise.all([y(t,n.slice(0,m),u),y(t,n.slice(m,n.length),u)]);case 23:return v=e.sent,O=Object(c.a)(v,2),j=O[0],p=O[1],e.abrupt("return",{results:j.results.concat(p.results),blockNumber:p.blockNumber});case 28:throw console.debug("Failed to fetch chunk inside retry",h),h;case 30:return a.toNumber()<u&&console.debug("Fetched results for old block number: ".concat(a.toString()," vs. ").concat(u)),e.abrupt("return",{results:o,blockNumber:a.toNumber()});case 32:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function M(e,t){if(!e||!t)return{};var n=e[t];return n?Object.keys(n).reduce((function(e,t){var r=n[t];return e[t]=Object.keys(r).filter((function(e){var t=parseInt(e);return!(t<=0)&&r[t]>0})).reduce((function(e,t){return Math.min(e,parseInt(t))}),1/0),e}),{}):{}}function I(e,t,n,r){return n&&r?e[n]?Object.keys(t).filter((function(c){var u=t[c],a=e[n][c];if(!a)return!0;var o=r-(u-1);return!(a.fetchingBlockNumber&&a.fetchingBlockNumber>=o)&&(!a.blockNumber||a.blockNumber<o)})):Object.keys(t):[]}function E(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.multicall})),n=Object(s.a)(t.callListeners,100),c=Object(i.a)(),b=Object(l.a)().chainId,f=Object(a.useRef)(),d=Object(a.useMemo)((function(){return M(n,b)}),[n,b]),h=Object(a.useMemo)((function(){return I(t.callResults,d,b,c)}),[b,t.callResults,d,c]),m=Object(a.useMemo)((function(){return JSON.stringify(h.sort())}),[h]);return Object(a.useEffect)((function(){var t,n=Object(g.u)();if(c&&b&&n){var a=JSON.parse(m);if(0!==a.length){var o,i,l=a.map((function(e){return Object(j.d)(e)})),s=function(e,t){if(t<1)throw new Error("maxChunkSize must be gte 1");if(e.length<=t)return[e];var n=Math.ceil(e.length/t),r=Math.ceil(e.length/n);return Object(p.a)(Array(n).keys()).map((function(t){return e.slice(t*r,t*r+r)}))}(l,N);if((null===(t=f.current)||void 0===t?void 0:t.blockNumber)!==c)null===(o=f.current)||void 0===o||null===(i=o.cancellations)||void 0===i||i.forEach((function(e){return e()}));e(Object(j.c)({calls:l,chainId:b,fetchingBlockNumber:c})),f.current={blockNumber:c,cancellations:s.map((function(t,o){var i=function(e,t){var n,c=t.n,a=t.minWait,o=t.maxWait,i=!1,l=new Promise(function(){var t=Object(u.a)(Object(r.a)().mark((function t(u,l){var s;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=l;case 1:return s=void 0,t.prev=3,t.next=6,e();case 6:return s=t.sent,i||(u(s),i=!0),t.abrupt("break",24);case 11:if(t.prev=11,t.t0=t.catch(3),!i){t.next=15;break}return t.abrupt("break",24);case 15:if(!(c<=0)&&t.t0 instanceof k){t.next=19;break}return l(t.t0),i=!0,t.abrupt("break",24);case 19:c--;case 20:return t.next=22,v(a,o);case 22:t.next=1;break;case 24:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e,n){return t.apply(this,arguments)}}());return{promise:l,cancel:function(){i||(i=!0,n(new O))}}}((function(){return y(n,t,c)}),{n:1/0,minWait:2500,maxWait:3500}),l=i.cancel;return i.promise.then((function(t){var n=t.results,r=t.blockNumber;f.current={cancellations:[],blockNumber:c};var u=s.slice(0,o).reduce((function(e,t){return e+t.length}),0),i=u+n.length;e(Object(j.g)({chainId:b,results:a.slice(u,i).reduce((function(e,t,r){var c;return e[t]=null!==(c=n[r])&&void 0!==c?c:null,e}),{}),blockNumber:r}))})).catch((function(n){n instanceof O?console.debug("Cancelled fetch for blockNumber",c):(console.error("Failed to fetch multicall chunk",t,b,n),e(Object(j.b)({calls:t,chainId:b,fetchingBlockNumber:c})))})),l}))}}}}),[b,e,m,c]),null}}}]);